---
phase: 07-deployment
type: execute
---

<objective>
Verify the deployed application is accessible from China and identify any access issues or performance problems.

Purpose: Ensure users in China can access and use the AI Image Generator without restrictions or severe performance issues.
Output: China access verification report with findings and recommendations.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./.claude/get-shit-done/templates/summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Auto-selected based on dependency graph (from frontmatter):
@.planning/phases/07-deployment/07-01-SUMMARY.md
@.planning/phases/07-deployment/07-02-SUMMARY.md
@.planning/phases/02-qwen-integration/02-01-SUMMARY.md

# Key files from frontmatter (relevant to this phase):
- Deployment URL from 07-02

**Tech stack available:** React 19, Vite 6, deployed app
**Established patterns:**
- Application deployed to [Vercel/Netlify/Cloudflare Pages]
- API proxy handles CORS
- DashScope API (Beijing region) for image generation

**Constraining decisions:**
- Phase 2: DashScope API Beijing region (optimal for China)
- Phase 7-02: App deployed to [platform]
- Project goal: Optimize for simplicity and China compatibility

**Issues being addressed:**
- Great Firewall may block certain hosting platforms
- CDN performance from China varies by platform
- API calls to DashScope must work from China
- User experience should be acceptable in China

**From STATE.md:**
- App deployed and functional
- Ready for China access verification
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create China access test script</name>
  <files>scripts/test-china-access.sh, CHINA-ACCESS-TEST.md</files>
  <action>
Create automated and manual test procedures for China access:

1. Create `scripts/test-china-access.sh` script:
   - Test deployment URL accessibility: curl -I https://your-app-url.com
   - Test response time: time curl https://your-app-url.com
   - Test API proxy: curl -X POST https://your-app-url.com/api/qwen
   - Check for blocked resources or timeouts
   - Measure TTFI (Time To First Interactive) estimate

2. Create `CHINA-ACCESS-TEST.md` documentation:
   - Manual testing steps for users in China
   - What to test: page load, image generation, download
   - How to report issues: latency, blocked resources, error messages
   - Expected performance metrics (load time < 5s, generation < 2m)
   - VPN testing: test with and without VPN to compare

3. Test from current location:
   - Run script: bash scripts/test-china-access.sh
   - Record baseline metrics (from non-China location)
   - Document current deployment URL and platform

WHY: Automated tests provide objective metrics. Manual tests from real China users identify actual user experience issues.
  </action>
  <verify>
- scripts/test-china-access.sh exists and is executable
- CHINA-ACCESS-TEST.md documents manual testing steps
- Script runs without errors
- Baseline metrics recorded
- Deployment URL documented
  </verify>
  <done>
China access testing infrastructure created with automated script and manual test documentation
  </done>
</task>

<task type="auto">
  <name>Task 2: Identify platform-specific China access issues</name>
  <files>CHINA-ACCESS-REPORT.md</files>
  <action>
Research and document platform-specific China access characteristics:

**If deployed to Vercel:**
- Research Vercel's China CDN coverage (Hong Kong, Singapore, Tokyo PoPs)
- Check if Vercel is blocked by Great Firewall (generally not blocked)
- Document typical latency from China (200-500ms from East China)
- Note: Vercel's mainland China edge locations are enterprise-only

**If deployed to Netlify:**
- Research Netlify's China CDN coverage
- Check if Netlify is blocked (generally not blocked)
- Document typical latency from China
- Note: Similar to Vercel, China access via Hong Kong/Singapore

**If deployed to Cloudflare Pages:**
- Research Cloudflare's China partnerships (China Telecom, China Unicom)
- Check if Cloudflare has mainland China edge (YES - rare among Western platforms)
- Document typical latency (better than Vercel/Netlify)
- Note: Workers have CPU time limits for long-running requests

Create CHINA-ACCESS-REPORT.md with:
- Platform analysis
- Expected China access quality
- Known limitations
- Alternative platforms if current one has issues
- Recommendations for improvement

WHY: Each platform has different China access characteristics. Understanding these helps set realistic expectations and identify potential issues.
  </action>
  <verify>
- CHINA-ACCESS-REPORT.md exists
- Platform-specific China access documented
- CDN coverage information included
- Latency estimates provided
- Alternative platforms listed if needed
  </verify>
  <done>
Platform-specific China access analysis documented with findings and recommendations
  </done>
</task>

<task type="auto">
  <name>Task 3: Test DashScope API access from deployment</name>
  <files>scripts/test-api-access.sh</files>
  <action>
Verify DashScope API is accessible from the deployed environment:

1. Create test script that simulates API calls from deployment region:
   - Test API endpoint: https://dashscope.aliyuncs.com
   - Test connectivity: curl -I https://dashscope.aliyuncs.com
   - Test authentication with API key
   - Measure response time
   - Test actual image generation request (small prompt)

2. Check if deployment region affects API access:
   - Vercel/Netlify functions usually run in us-east-1
   - DashScope API is in Beijing (cn-beijing)
   - Cross-region latency: us-east-1 to cn-beijing can be 200-400ms
   - Document if this impacts user experience

3. Verify image generation works end-to-end:
   - Generate test image from deployment
   - Confirm image URL is returned
   - Confirm image loads from DashScope CDN
   - Check if DashScope image URLs are accessible from China

4. Document findings:
   - API response time
   - Image generation time
   - Any region-specific issues
   - Recommendations for optimization

WHY: DashScope API must be accessible from deployment environment. Cross-region calls add latency that affects UX.
  </action>
  <verify>
- Test script executes successfully
- API connectivity confirmed
- Response time measured and documented
- Image generation tested end-to-end
- Findings documented in report
  </verify>
  <done>
DashScope API access verified from deployment, performance metrics documented
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>China access testing infrastructure, platform analysis, and API access verification</what-built>
  <how-to-verify>
    1. Review CHINA-ACCESS-TEST.md:
       - Confirm manual testing steps are clear
       - Confirm expected performance metrics are documented
       - Confirm issue reporting process is defined

    2. Review CHINA-ACCESS-REPORT.md:
       - Confirm platform-specific China access analysis is complete
       - Confirm CDN coverage information is accurate
       - Confirm latency estimates are realistic
       - Confirm alternatives are listed if needed

    3. Test deployment URL (if you have access to China network or VPN):
       - Visit deployment URL from China network/VPN
       - Time page load: should be < 5 seconds
       - Test image generation: should complete in < 2 minutes
       - Check for any blocked resources
       - Note any errors or warnings

    4. If you DON'T have China access:
       - Document that live testing is needed from China-based user
       - Provide test script for them to run
       - Set up process for collecting their feedback

    5. Verify API access:
       - Check API test script output
       - Confirm DashScope API is accessible
       - Confirm response times are acceptable

    Expected outcome:
    - Testing infrastructure is complete
    - Platform analysis documents China access quality
    - API access is verified
    - Manual testing process is clear for China-based users
    - Any issues are documented with recommendations
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] China access test script created
- [ ] Manual testing documentation complete
- [ ] Platform-specific China access analysis done
- [ ] DashScope API access verified from deployment
- [ ] Performance metrics documented
- [ ] Recommendations provided for any issues found
- [ ] Process defined for collecting China user feedback
</verification>

<success_criteria>

- China access testing infrastructure complete
- Platform China access characteristics documented
- API access verified with performance metrics
- Manual testing process clear for China-based users
- Findings documented with actionable recommendations
- Known limitations and workarounds identified
  </success_criteria>

<output>
After completion, create `.planning/phases/07-deployment/07-03-SUMMARY.md`:

# Phase 7 Plan 3: China Access Verification Summary

**China access verified with testing infrastructure, platform analysis, and performance documentation**

## Accomplishments

- Created automated China access testing script
- Documented manual testing procedures for China users
- Analyzed platform-specific China access characteristics
- Verified DashScope API access from deployment environment
- Documented performance metrics and latency expectations
- Identified any limitations and provided recommendations

## Files Created/Modified

- `scripts/test-china-access.sh` - Automated testing script
- `CHINA-ACCESS-TEST.md` - Manual testing documentation
- `CHINA-ACCESS-REPORT.md` - Platform analysis and findings
- `scripts/test-api-access.sh` - API connectivity testing

## China Access Findings

**Platform**: [Vercel/Netlify/Cloudflare Pages]
**China Access Quality**: [Good/Acceptable/Poor]
**Expected Latency**: [X ms from East China]
**CDN Coverage**: [Hong Kong/Singapore/Mainland China]
**Blocked Resources**: [None/Some/Many]

**DashScope API Access**:
- API endpoint: ✅ Accessible
- Response time: [X ms]
- Image generation: ✅ Working
- Image CDN: ✅ Accessible from China

## Performance Metrics

- Page load time (baseline): [X seconds]
- Image generation time: [X-X minutes]
- API response time: [X ms]
- Cross-region latency impact: [Yes/No]

## Issues Identified

- [Any issues found during testing]
- [Performance bottlenecks]
- [Blocked resources]
- [Platform limitations]

## Recommendations

- [Immediate improvements if needed]
- [Long-term optimizations]
- [Alternative platforms if current has issues]
- [CDN optimization suggestions]
- [Region-specific optimizations]

## Next Steps

**If China access is good**:
- Phase 7 complete, ready for production use
- Monitor performance and user feedback
- Consider optimizations based on usage patterns

**If China access has issues**:
- Consider migrating to Cloudflare Pages (better China CDN)
- Add China-specific CDN (if platform supports)
- Implement region-specific optimizations
- Test alternative platforms

**If unable to test from China**:
- Deploy to China-based user for testing
- Collect feedback and metrics
- Iterate based on real-world usage

## Phase 7 Complete

Deployment phase complete with:
- Production build configured (07-01)
- Application deployed with API proxy (07-02)
- China access verified (07-03)
- Ready for production use or further optimization
</output>
